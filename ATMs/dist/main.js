!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";function n(){this.eventTable={}}o.r(t),n.prototype={on(e,t){this.eventTable[e]||(this.eventTable[e]=[]),this.eventTable[e].push(t)},emit(e,...t){this.eventTable[e]&&this.eventTable[e].forEach(e=>e.apply(this,t))}};var r=n;function c(){r.call(this),this.element=function(e){const[,t,o]=/<(.*?|(?:.*?\n)+.*?)>(.*?|(?:.*?\n)+.*?)<\/.+?>/.exec(e),n=/\w+/.exec(t),r=document.createElement(n),c=/([\w|-]+)="(.*?|(?:.*?\n?)+.*?)"/g;let s;for(;s=c.exec(t);)r.setAttribute(s[1],s[2]);return r.innerHTML=o.trim(),r}(this.render())}c.prototype=Object.create(r.prototype),c.prototype.constructor=c;var s=c;function i(e){s.call(this),this.id=e,this.element.addEventListener("click",this.handleClick.bind(this))}i.prototype=Object.create(s.prototype),i.prototype.constructor=i,i.prototype.render=function(){return`<span id="${this.id}">&times;</span>`},i.prototype.handleClick=function(){this.emit("CloseComponent_Click")};var l=i;function u(){r.call(this),this.countUsers=0,this.isWork=!0,this.isFree=!0}u.prototype=Object.create(r.prototype),u.prototype.constructor=u,u.prototype.incrementUsers=function(){this.countUsers++},u.prototype.changeColor=function(e,t){document.getElementById(e).style.backgroundColor=t},u.prototype.changeState=function(e,t){document.getElementById(e).innerHTML=t};var a=u;function d(e){this.closeBtn=new l(e),this.core=new a,this.closeBtn.on("CloseComponent_Click",()=>this.emit("CloseComponent_Click")),this.id=e,s.call(this),this.element.appendChild(this.closeBtn.element)}d.prototype=Object.create(s.prototype),d.prototype.constructor=d,d.prototype.render=function(){return`<div id="wrapATM${this.id}">\n                <p id="atm${this.id}-counter">${this.core.countUsers}</p>\n                <div class = "atm" id ="atm-${this.id}"></div>\n            </div>`};var p=d;var m=(e,t)=>{let o=e-.5+Math.random()*(t-e+1);return o=Math.round(o)};function h(){this.numUsers=10}h.prototype.increment=function(e,t){const o=this;setInterval(()=>{o.numUsers++,o.changeState("user-count",o.numUsers),console.log(`Number of users in queue = ${o.numUsers}`)},1e3*m(e,t))},h.prototype.clearInterval=function(){clearInterval()},h.prototype.changeState=function(e,t){document.getElementById(e).innerHTML=t};var y=h;function f(){s.call(this),this.core=new y}f.prototype=Object.create(s.prototype),f.prototype.constructor=f,f.prototype.render=function(){return'<p id="user-count">0</p>'};var g=f;const v=document.getElementById("atms"),b=document.getElementById("counter"),C=document.getElementById("btn"),T=document.getElementById("add-interval"),U=document.getElementById("input1"),E=document.getElementById("input2"),$=new g,k=[new p(0),new p(1)];let I=[];T.addEventListener("click",()=>{if(0!==U.value&&0!==E.value){let e=U.value,t=E.value;$.core.clearInterval(),$.core.increment(e,t)}else console.log("Are you stupid???")}),I=k.map((e,t)=>{e.on("CloseComponent_Click",()=>{e.core.isWork=!1;const o=document.getElementById("atms"),n=document.getElementById(`wrapATM${t}`);o.removeChild(n)}),e.core.on("busy",()=>{e.core.isFree=!1,e.core.changeColor(`atm-${t}`,"red"),e.core.countUsers+=1,$.core.numUsers-=1,console.log(`ATM ${t} serviced:`,e.core.countUsers),setTimeout(()=>{e.core.changeState(`atm${t}-counter`,e.core.countUsers),e.core.emit("free")},1e3*m(2,4))}),e.core.on("free",()=>{e.core.isFree=!0,e.core.changeColor(`atm-${t}`,"green"),$.core.numUsers>0&&e.core.isWork?setTimeout(()=>{e.core.emit("busy")},1e3):!0!==e.core.isWork?console.log(`Element ATM${t} was deleted. Last num = ${e.core.countUsers}`):console.log("queue is about nothing")}),console.log(e),v.appendChild(e.element),console.log(k),e.core.emit("free")}),b.appendChild($.element),$.core.increment(1,4),C.addEventListener("click",()=>{const e=new p(I.length);e.on("CloseComponent_Click",()=>{const t=document.getElementById("atms"),o=document.getElementById(`wrapATM${e.id}`);t.removeChild(o),e.core.isWork=!1}),e.core.on("busy",()=>{e.core.isFree=!1,e.core.countUsers+=1,$.core.numUsers-=1,console.log(`ATM ${e.id} serviced: `,e.core.countUsers),setTimeout(()=>{e.core.emit("free"),e.core.changeState(`atm${e.id}-counter`,e.core.countUsers),e.core.changeColor(`atm-${e.id}`,"green")},1e3*m(2,4))}),e.core.on("free",()=>{$.core.numUsers>0&&e.core.isWork?setTimeout(()=>{e.core.emit("busy"),e.core.changeColor(`atm-${e.id}`,"red")},1e3):!0!==e.core.isWork?console.log(`Element ATM${e.id} was deleted. Last num = ${e.core.countUsers}`):console.log("queue is about nothing")}),e.core.emit("free"),I.push(e),v.appendChild(e.element)}),console.log($.core.numUsers)}]);