!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";function n(){this.eventTable={}}o.r(t),n.prototype={on(e,t){this.eventTable[e]||(this.eventTable[e]=[]),this.eventTable[e].push(t)},emit(e,...t){this.eventTable[e]&&this.eventTable[e].forEach(e=>e.apply(this,t))}};var r=n;function c(){r.call(this),this.element=function(e){const[,t,o]=/<(.*?|(?:.*?\n)+.*?)>(.*?|(?:.*?\n)+.*?)<\/.+?>/.exec(e),n=/\w+/.exec(t),r=document.createElement(n),c=/([\w|-]+)="(.*?|(?:.*?\n?)+.*?)"/g;let s;for(;s=c.exec(t);)r.setAttribute(s[1],s[2]);return r.innerHTML=o.trim(),r}(this.render())}c.prototype=Object.create(r.prototype),c.prototype.constructor=c;var s=c;function i(e){s.call(this),this.id=e,this.element.addEventListener("click",this.handleClick.bind(this))}i.prototype=Object.create(s.prototype),i.prototype.constructor=i,i.prototype.render=function(){return`<span id="${this.id}">&times;</span>`},i.prototype.handleClick=function(){this.emit("CloseComponent_Click")};var u=i;function l(){r.call(this),this.countUsers=0,this.isWork=!0,this.isFree=!0}l.prototype=Object.create(r.prototype),l.prototype.constructor=l,l.prototype.incrementUsers=function(){this.countUsers++},l.prototype.changeColor=function(e,t){document.getElementById(e).style.backgroundColor=t},l.prototype.changeState=function(e,t){document.getElementById(e).innerHTML=t};var a=l;function d(e){this.closeBtn=new u(e),this.core=new a,this.closeBtn.on("CloseComponent_Click",()=>this.emit("CloseComponent_Click")),this.id=e,s.call(this),this.element.appendChild(this.closeBtn.element)}d.prototype=Object.create(s.prototype),d.prototype.constructor=d,d.prototype.render=function(){return`<div id="wrapATM${this.id}">\n                <p class = "speech" id="atm${this.id}-counter"> Users served: ${this.core.countUsers}</p>\n                <div class = "atm">\n                  <div class = "display" id ="atm-${this.id}"></div>\n                </div>\n            </div>`};var m=d;var p=(e,t)=>{let o=e-.5+Math.random()*(t-e+1);return o=Math.round(o)};function h(){this.numUsers=20}let y;h.prototype.increment=function(e,t){return new Promise((o,n)=>{const r=this;r.changeState("user-count",r.numUsers),y=setInterval(()=>{r.numUsers+=1,r.changeState("user-count",r.numUsers),console.log(`Number of users in queue = ${r.numUsers}`),o(r.numUsers)},1e3*p(e,t))})},h.prototype.clearInterval=function(){clearInterval(y)},h.prototype.changeState=function(e,t){document.getElementById(e).innerHTML=t};var f=h;function g(){s.call(this),this.core=new f}g.prototype=Object.create(s.prototype),g.prototype.constructor=g,g.prototype.render=function(){return'<p id="user-count">0</p>'};var v=g;const b=document.getElementById("atms"),C=document.getElementById("counter"),U=document.getElementById("btn"),T=document.getElementById("add-interval"),$=document.getElementById("input1"),E=document.getElementById("input2"),k=new v,I=[new m(0),new m(1)];let w,B,M=[];function O(){const e=new m(M.length);e.on("CloseComponent_Click",()=>{const t=document.getElementById("atms"),o=document.getElementById(`wrapATM${e.id}`);t.removeChild(o),e.core.isWork=!1}),e.core.on("busy",()=>{e.core.isFree=!1,e.core.countUsers+=1,k.core.numUsers-=1,console.log(`ATM ${e.id} serviced: `,e.core.countUsers),setTimeout(()=>{e.core.emit("free"),e.core.changeState(`atm${e.id}-counter`,`Users served: ${e.core.countUsers}`),e.core.changeColor(`atm-${e.id}`,"green")},1e3*p(2,4))}),e.core.on("free",()=>{k.core.numUsers>0&&e.core.isWork?setTimeout(()=>{e.core.emit("busy"),e.core.changeColor(`atm-${e.id}`,"red")},1e3):!0!==e.core.isWork?console.log(`Element ATM${e.id} was deleted. Last num = ${e.core.countUsers}`):(console.log("queue is about nothing"),setTimeout(()=>{e.core.emit("free")},1e3*p(w,B)+6e3))}),e.core.emit("free"),M.push(e),b.appendChild(e.element)}T.addEventListener("click",()=>{w=$.value,B=E.value,""!==w&&""!==B?0!==w&&0!==w&&0!==B&&(k.core.clearInterval(),k.core.increment(w,B),k.core.changeState("user-count",k.core.numUsers)):console.log("Are you stupid???")}),M=I.map((e,t)=>{e.on("CloseComponent_Click",()=>{e.core.isWork=!1;const o=document.getElementById("atms"),n=document.getElementById(`wrapATM${t}`);o.removeChild(n)}),e.core.on("busy",()=>{e.core.isFree=!1,e.core.changeColor(`atm-${t}`,"red"),e.core.countUsers+=1,k.core.numUsers-=1,console.log(`ATM ${t} serviced:`,e.core.countUsers),setTimeout(()=>{e.core.changeState(`atm${t}-counter`,`Users served: ${e.core.countUsers}`),k.core.changeState("user-count",k.core.numUsers),e.core.emit("free")},1e3*p(2,4))}),e.core.on("free",()=>{e.core.isFree=!0,e.core.changeColor(`atm-${t}`,"green"),k.core.numUsers>0&&e.core.isWork?setTimeout(()=>{e.core.emit("busy")},1e3):!0!==e.core.isWork?console.log(`Element ATM${t} was deleted. Last num = ${e.core.countUsers}`):(console.log("queue is about nothing"),setTimeout(()=>{e.core.emit("free")},1e3*p(w,B)+5e3))}),b.appendChild(e.element),e.core.emit("free")}),w=1,B=4,C.appendChild(k.element),k.core.increment(w,B).then(e=>{e>20&&(console.log("OK"),O())}).then(e=>{e<5&&console.log(e)}),U.addEventListener("click",()=>{O()})}]);